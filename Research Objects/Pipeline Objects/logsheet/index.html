
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Mitchell Tillman">
      
      
        <link rel="canonical" href="https://researchos.github.io/ResearchOS/Research%20Objects/Pipeline%20Objects/logsheet/">
      
      
        <link rel="prev" href="../analysis/">
      
      
        <link rel="next" href="../subset/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.15">
    
    
      
        <title>Logsheet - ResearchOS</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.7e359304.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#logsheet" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="ResearchOS" class="md-header__button md-logo" aria-label="ResearchOS" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ResearchOS
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Logsheet
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/ResearchOS/ResearchOS" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ResearchOS
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../Home/" class="md-tabs__link">
          
  
  Home

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../Getting%20Started/installation/" class="md-tabs__link">
          
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../research_object/" class="md-tabs__link">
          
  
  Research Objects

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../DiGraph/digraph/" class="md-tabs__link">
          
  
  DiGraph

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../SQL%20Database/" class="md-tabs__link">
          
  
  Backend

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="ResearchOS" class="md-nav__button md-logo" aria-label="ResearchOS" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    ResearchOS
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ResearchOS/ResearchOS" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ResearchOS
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Home
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Home/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Home/roadmap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Roadmap
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Getting%20Started/installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Getting%20Started/first_project/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    First Project
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Research Objects
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Research Objects
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../research_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Research Objects
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variable/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Variable
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Data Objects
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Data Objects
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Data%20Objects/data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Objects
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Data%20Objects/dataset/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dataset
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Data%20Objects/defining_data_objects/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Defining Data Objects
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" checked>
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Pipeline Objects
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            Pipeline Objects
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pipeline_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pipeline Objects
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_4_2" >
        
          
          <label class="md-nav__link" for="__nav_3_4_2" id="__nav_3_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Runnables
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4_2">
            <span class="md-nav__icon md-icon"></span>
            Runnables
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../runnables/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Runnables
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../process/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Process
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plot
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../stats/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Stats
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../project/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Project
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../analysis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Logsheet
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Logsheet
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Setting Attributes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Setting Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#logsheet-path" class="md-nav__link">
    <span class="md-ellipsis">
      Logsheet Path
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#headers" class="md-nav__link">
    <span class="md-ellipsis">
      Headers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#number-of-header-rows" class="md-nav__link">
    <span class="md-ellipsis">
      Number of Header Rows
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-column-names" class="md-nav__link">
    <span class="md-ellipsis">
      Class Column Names
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.ResearchOS.PipelineObjects.logsheet.Logsheet" class="md-nav__link">
    <span class="md-ellipsis">
      Logsheet
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.ResearchOS.PipelineObjects.logsheet.Logsheet.read_logsheet" class="md-nav__link">
    <span class="md-ellipsis">
      read_logsheet
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../subset/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Subset
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    DiGraph
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            DiGraph
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../DiGraph/digraph/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DiGraph
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Backend
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Backend
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../SQL%20Database/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SQLite Database
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Setting Attributes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Setting Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#logsheet-path" class="md-nav__link">
    <span class="md-ellipsis">
      Logsheet Path
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#headers" class="md-nav__link">
    <span class="md-ellipsis">
      Headers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#number-of-header-rows" class="md-nav__link">
    <span class="md-ellipsis">
      Number of Header Rows
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-column-names" class="md-nav__link">
    <span class="md-ellipsis">
      Class Column Names
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.ResearchOS.PipelineObjects.logsheet.Logsheet" class="md-nav__link">
    <span class="md-ellipsis">
      Logsheet
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.ResearchOS.PipelineObjects.logsheet.Logsheet.read_logsheet" class="md-nav__link">
    <span class="md-ellipsis">
      read_logsheet
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="logsheet">Logsheet</h1>
<h2 id="introduction">Introduction</h2>
<p>Most researchers take notes during their experiments. These notes come in many forms, from informal handwritten to very formalized forms or spreadsheets. The <code>Logsheet</code> object is designed to capture these notes in a structured way. The <code>Logsheet</code> object is a Pipeline Object, and must be the first object in the pipeline because it constructs the Data Objects in the <code>Dataset</code>. </p>
<p>The format of the <code>Logsheet</code> spreadsheets will vary widely between labs and disciplines. However, there are broadly two types of columns in a <code>Logsheet</code>: <code>Data Object</code> columns and <code>Variable</code> columns. <code>Data Object</code> columns are used to define the <code>Dataset</code> <code>schema</code>, and <code>Variable</code> columns define attributes for each <code>Data Object</code>. </p>
<h2 id="setting-attributes">Setting Attributes</h2>
<h3 id="logsheet-path">Logsheet Path</h3>
<p>The path to the logsheet file is computer-specific. I recommend that you put the logsheet path in a <code>paths.py</code> file and import it into the research_objects/logsheets.py file. By putting the <code>paths.py</code> file into the <code>.gitignore</code> file (keeping it out of the project's GitHub repository) you can maintain different paths for different computers.</p>
<h3 id="headers">Headers</h3>
<p>The headers attribute is a list of tuples. Each tuple contains, in order: the name of the column (which must match the first row of the column exactly), the data type of the column, the custom <code>Data Object</code> class that the column belongs to, and the <code>Variable</code> object that the column is associated with. For example:
<div class="highlight"><pre><span></span><code><span class="n">headers</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s2">&quot;Subject&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Subject</span><span class="p">,</span> <span class="n">vr</span><span class="o">.</span><span class="n">subject_name</span><span class="p">),</span> <span class="c1"># This is a `Data Object` column</span>
    <span class="p">(</span><span class="s2">&quot;Trial&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Trial</span><span class="p">,</span> <span class="n">vr</span><span class="o">.</span><span class="n">trial_name</span><span class="p">),</span> <span class="c1"># This is a `Data Object` column</span>
    <span class="p">(</span><span class="s2">&quot;Value&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">Trial</span><span class="p">,</span> <span class="n">vr</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="c1"># This is a `Variable` column</span>
<span class="p">]</span>
</code></pre></div></p>
<h3 id="number-of-header-rows">Number of Header Rows</h3>
<p>This attribute is an integer that specifies the number of rows at the top of the logsheet that are not part of the data. This is useful for logsheet files that have one or more header rows that describe the contents of the columns.</p>
<h3 id="class-column-names">Class Column Names</h3>
<p>This attribute is a dictionary that maps the names of the <code>Data Object</code> columns to the custom <code>Data Object</code> classes that they belong to. Note that the keys must match the first row of the column exactly. For example:
<div class="highlight"><pre><span></span><code><span class="n">class_column_names</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Subject&quot;</span><span class="p">:</span> <span class="n">Subject</span><span class="p">,</span>
    <span class="s2">&quot;Trial&quot;</span><span class="p">:</span> <span class="n">Trial</span>
<span class="p">}</span>
</code></pre></div></p>


<div class="doc doc-object doc-class">



<a id="src.ResearchOS.PipelineObjects.logsheet.Logsheet"></a>
  <div class="doc doc-contents first">
          <p class="doc doc-class-bases">
            Bases: <code><span title="ResearchOS.PipelineObjects.pipeline_object.PipelineObject">PipelineObject</span></code></p>


            <details class="quote">
              <summary>Source code in <code>src/ResearchOS/PipelineObjects/logsheet.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Logsheet</span><span class="p">(</span><span class="n">PipelineObject</span><span class="p">):</span>

    <span class="n">prefix</span> <span class="o">=</span> <span class="s2">&quot;LG&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">all_default_attrs</span><span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">],</span> <span class="n">headers</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="n">all_default_attrs</span><span class="p">[</span><span class="s2">&quot;headers&quot;</span><span class="p">],</span>
                <span class="n">num_header_rows</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">all_default_attrs</span><span class="p">[</span><span class="s2">&quot;num_header_rows&quot;</span><span class="p">],</span> <span class="n">class_column_names</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">all_default_attrs</span><span class="p">[</span><span class="s2">&quot;class_column_names&quot;</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initialized</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">headers</span> <span class="o">=</span> <span class="n">headers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_header_rows</span> <span class="o">=</span> <span class="n">num_header_rows</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">class_column_names</span> <span class="o">=</span> <span class="n">class_column_names</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c1">### Logsheet path</span>

    <span class="k">def</span> <span class="nf">validate_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">action</span><span class="p">:</span> <span class="n">Action</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate the logsheet path.</span>

<span class="sd">        Args:</span>
<span class="sd">            self</span>
<span class="sd">            path (string) : logsheet path as a string</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: invalid path format&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">path</span> <span class="o">==</span> <span class="n">default</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="c1"># 1. Check that the path exists in the file system.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Path must be a string!&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Specified path does not exist!&quot;</span><span class="p">)</span>
        <span class="c1"># 2. Check that the path is a file.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Specified path is not a file!&quot;</span><span class="p">)</span>
        <span class="c1"># 3. Check that the file is a CSV.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s2">&quot;csv&quot;</span><span class="p">,</span> <span class="s2">&quot;xlsx&quot;</span><span class="p">,</span> <span class="s2">&quot;xls&quot;</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Specified file is not a CSV!&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">load_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">:</span> <span class="n">Action</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load the logsheet path.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ResearchObjectHandler</span><span class="o">.</span><span class="n">get_user_computer_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;path&quot;</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>

    <span class="c1">### Logsheet headers</span>

    <span class="k">def</span> <span class="nf">validate_headers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">headers</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">action</span><span class="p">:</span> <span class="n">Action</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate the logsheet headers. These are the headers that are in the logsheet file.</span>
<span class="sd">        The headers must be a list of tuples, where each tuple has 3 elements:</span>
<span class="sd">        1. A string (the name of the header)</span>
<span class="sd">        2. A type (the type of the header)</span>
<span class="sd">        3. A valid variable ID (the ID of the Variable that the header corresponds to)</span>

<span class="sd">        Args: </span>
<span class="sd">            self</span>
<span class="sd">            headers (list) : headers in the logsheet file as a list of tuples each with 3 elements</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: incorrect &#39;&#39;header&#39;&#39; format&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">headers</span> <span class="o">==</span> <span class="n">default</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validate_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="c1"># 1. Check that the headers are a list.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">headers</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Headers must be a list!&quot;</span><span class="p">)</span>

        <span class="c1"># 2. Check that the headers are a list of tuples and meet the other requirements.        </span>
        <span class="k">for</span> <span class="n">header</span> <span class="ow">in</span> <span class="n">headers</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">header</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Headers must be a list of tuples!&quot;</span><span class="p">)</span>
            <span class="c1"># 3. Check that each header tuple has 3 elements.        </span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">header</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">4</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Each header tuple must have 4 elements!&quot;</span><span class="p">)</span>
            <span class="c1"># 4. Check that the first element of each header tuple is a string.        </span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;First element of each header tuple must be a string!&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">header</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Second element of each header tuple must be a Python type!&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">header</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">DataObject</span><span class="o">.</span><span class="n">__subclasses__</span><span class="p">():</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Third element of each header tuple must be a ResearchObject subclass!&quot;</span><span class="p">)</span>
            <span class="c1"># 6. Check that the third element of each header tuple is a valid variable ID.                </span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="mi">3</span><span class="p">],(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Variable</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Fourth element of each header tuple must be a valid pre-existing variable ID OR the variable object itself!&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">Variable</span><span class="o">.</span><span class="n">prefix</span><span class="p">)</span> <span class="ow">and</span> <span class="n">ResearchObjectHandler</span><span class="o">.</span><span class="n">object_exists</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">action</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Fourth element of each header tuple (if provided as a str) must be a valid pre-existing variable ID!&quot;</span><span class="p">)</span>

        <span class="n">logsheet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_and_clean_logsheet</span><span class="p">(</span><span class="n">nrows</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">headers_in_logsheet</span> <span class="o">=</span> <span class="n">logsheet</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">header_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">header</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">header</span> <span class="ow">in</span> <span class="n">headers</span><span class="p">]</span>
        <span class="n">missing</span> <span class="o">=</span> <span class="p">[</span><span class="n">header</span> <span class="k">for</span> <span class="n">header</span> <span class="ow">in</span> <span class="n">headers_in_logsheet</span> <span class="k">if</span> <span class="n">header</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">header_names</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">missing</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The headers </span><span class="si">{</span><span class="n">missing</span><span class="si">}</span><span class="s2"> do not match between logsheet and code!&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">to_json_headers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">headers</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">action</span><span class="p">:</span> <span class="n">Action</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert the headers to a JSON string.</span>
<span class="sd">        Also sets the VR&#39;s name and level.</span>

<span class="sd">        Args:</span>
<span class="sd">            self</span>
<span class="sd">            headers (list) : headers in the logsheet file as a list of tuples</span>

<span class="sd">        Returns:</span>
<span class="sd">            &#39;&#39;headers&#39;&#39; as a JSON string using &#39;&#39;json.dumps&#39;&#39;&quot;&quot;&quot;</span>
        <span class="n">str_headers</span> <span class="o">=</span> <span class="p">[]</span>        
        <span class="k">for</span> <span class="n">header</span> <span class="ow">in</span> <span class="n">headers</span><span class="p">:</span>
            <span class="c1"># Update the Variable object with the name if it is not already set, and the level.</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">Variable</span><span class="p">):</span>
                <span class="n">vr</span> <span class="o">=</span> <span class="n">header</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>                
            <span class="k">else</span><span class="p">:</span>
                <span class="n">vr</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="nb">id</span> <span class="o">=</span> <span class="n">header</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">action</span> <span class="o">=</span> <span class="n">action</span><span class="p">)</span>
            <span class="n">default_attrs</span> <span class="o">=</span> <span class="n">DefaultAttrs</span><span class="p">(</span><span class="n">vr</span><span class="p">)</span><span class="o">.</span><span class="n">default_attrs</span>
            <span class="n">kwarg_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">header</span><span class="p">[</span><span class="mi">0</span><span class="p">]}</span>
            <span class="n">vr</span><span class="o">.</span><span class="n">_setattrs</span><span class="p">(</span><span class="n">default_attrs</span><span class="p">,</span> <span class="n">kwarg_dict</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">str_headers</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">header</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="mi">1</span><span class="p">])[</span><span class="mi">8</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">header</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">prefix</span><span class="p">,</span> <span class="n">vr</span><span class="o">.</span><span class="n">id</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">str_headers</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">from_json_headers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">json_var</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">action</span><span class="p">:</span> <span class="n">Action</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert the JSON string to a list of headers.</span>


<span class="sd">        Args:</span>
<span class="sd">            self</span>
<span class="sd">            json_var (string) : JSON string returned by &#39;&#39;to_json_headers&#39;&#39;</span>

<span class="sd">        Returns:</span>
<span class="sd">            formatted list of headers&quot;&quot;&quot;</span>
        <span class="n">subclasses</span> <span class="o">=</span> <span class="n">DataObject</span><span class="o">.</span><span class="n">__subclasses__</span><span class="p">()</span>
        <span class="n">str_var</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json_var</span><span class="p">)</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">mapping</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;str&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
            <span class="s2">&quot;int&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
            <span class="s2">&quot;float&quot;</span><span class="p">:</span> <span class="nb">float</span>
        <span class="p">}</span>
        <span class="k">for</span> <span class="n">header</span> <span class="ow">in</span> <span class="n">str_var</span><span class="p">:</span>
            <span class="n">cls_header</span> <span class="o">=</span> <span class="p">[</span><span class="bp">cls</span> <span class="k">for</span> <span class="bp">cls</span> <span class="ow">in</span> <span class="n">subclasses</span> <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">prefix</span> <span class="o">==</span> <span class="n">header</span><span class="p">[</span><span class="mi">2</span><span class="p">]][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">headers</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">header</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">mapping</span><span class="p">[</span><span class="n">header</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">cls_header</span><span class="p">,</span> <span class="n">header</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>                
        <span class="k">return</span> <span class="n">headers</span>

    <span class="c1">### Num header rows</span>

    <span class="k">def</span> <span class="nf">validate_num_header_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_header_rows</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">action</span><span class="p">:</span> <span class="n">Action</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate the number of header rows. If it is not valid, the value is rejected.</span>

<span class="sd">        Args:</span>
<span class="sd">            self</span>
<span class="sd">            num_header_rows (int) : number of header rows as an integer</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: invalid &#39;&#39;num_header_rows&#39;&#39; format&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">num_header_rows</span> <span class="o">==</span> <span class="n">default</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">num_header_rows</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Num header rows must be numeric!&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">num_header_rows</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Num header rows must be positive!&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">num_header_rows</span> <span class="o">%</span> <span class="mi">1</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Num header rows must be an integer!&quot;</span><span class="p">)</span>  

    <span class="c1">### Class column names</span>

    <span class="k">def</span> <span class="nf">validate_class_column_names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">class_column_names</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">action</span><span class="p">:</span> <span class="n">Action</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate the class column names. Must be a dict where the keys are the column names in the logsheet and the values are the DataObject subclasses.</span>

<span class="sd">        Must be a dict where the keys are the column names in the logsheet and the values are the DataObject subclasses.</span>

<span class="sd">        Args:</span>
<span class="sd">            self</span>
<span class="sd">            class_column_names (dict) : dictionary where keys are logsheet column names &amp; values are &#39;&#39;DataObject&#39;&#39; subcclasses</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: incorrect format of &#39;&#39;class_column_names&#39;&#39; &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">class_column_names</span> <span class="o">==</span> <span class="n">default</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validate_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="c1"># 1. Check that the class column names are a dict.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">class_column_names</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Class column names must be a dict!&quot;</span><span class="p">)</span>
        <span class="c1"># 2. Check that the class column names are a dict of str to type.        </span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">class_column_names</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Keys of class column names must be strings!&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">DataObject</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Values of class column names must be Python types that subclass DataObject!&quot;</span><span class="p">)</span>

        <span class="n">headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_and_clean_logsheet</span><span class="p">(</span><span class="n">nrows</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="n">header</span> <span class="ow">in</span> <span class="n">headers</span> <span class="k">for</span> <span class="n">header</span> <span class="ow">in</span> <span class="n">class_column_names</span><span class="o">.</span><span class="n">keys</span><span class="p">()]):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The class column names must be in the logsheet headers!&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">from_json_class_column_names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">json_var</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">action</span><span class="p">:</span> <span class="n">Action</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert the dict from JSON string where values are class prefixes to a dict where keys are column names and values are DataObject subclasses.</span>
<span class="sd">        QUESTION confused about data flow/the order that these functions are called&quot;&quot;&quot;</span>     
        <span class="n">prefix_var</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json_var</span><span class="p">)</span>
        <span class="n">class_column_names</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">all_classes</span> <span class="o">=</span> <span class="n">ResearchObjectHandler</span><span class="o">.</span><span class="n">_get_subclasses</span><span class="p">(</span><span class="n">ResearchObject</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="n">prefix_var</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="bp">cls</span> <span class="ow">in</span> <span class="n">all_classes</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="s2">&quot;prefix&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">cls</span><span class="o">.</span><span class="n">prefix</span> <span class="o">==</span> <span class="n">prefix</span><span class="p">:</span>
                    <span class="n">class_column_names</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="bp">cls</span>
                    <span class="k">break</span>
        <span class="k">return</span> <span class="n">class_column_names</span>

    <span class="k">def</span> <span class="nf">to_json_class_column_names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">action</span><span class="p">:</span> <span class="n">Action</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert the dict from a dict where keys are column names and values are DataObject subclasses to a JSON string where values are class prefixes.</span>

<span class="sd">        Convert the dict from a dict where keys are column names and values are DataObject subclasses to a JSON string where values are class prefixes.</span>
<span class="sd">        UNCLEAR QUESTION does it return a JSON string or a dict? is the JSON string just the format of the new dict values?</span>

<span class="sd">        Args:</span>
<span class="sd">            self</span>
<span class="sd">            var (dict) : same dict as &#39;&#39;class_column_name&#39;&#39; in &#39;&#39;validate_class_column_names&#39;&#39;</span>

<span class="sd">        Returns:</span>
<span class="sd">            new dict where keys are are logsheet column names and values are a JSON sring of class prefixes IDK&quot;&quot;&quot;</span>        
        <span class="n">prefix_var</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">var</span><span class="p">:</span>
            <span class="n">prefix_var</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">var</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">prefix</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">prefix_var</span><span class="p">)</span>

    <span class="c1">#################### Start class-specific methods ####################</span>
    <span class="k">def</span> <span class="nf">_read_and_clean_logsheet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nrows</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Read the logsheet (CSV only) and clean it.&quot;&quot;&quot;</span>
        <span class="n">logsheet</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Windows&quot;</span><span class="p">:</span>
            <span class="n">first_elem_prefix</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">first_elem_prefix</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\ufeff</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s2">&quot;xlsx&quot;</span><span class="p">,</span> <span class="s2">&quot;xls&quot;</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;CSV files only!&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">quotechar</span><span class="o">=</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>            

            <span class="k">for</span> <span class="n">row_num</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">reader</span><span class="p">):</span>                                    
                <span class="n">logsheet</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">nrows</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">row_num</span> <span class="o">==</span> <span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="k">break</span>

        <span class="c1"># 7. Check that the headers all match the logsheet.</span>
        <span class="n">logsheet</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">logsheet</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">first_elem_prefix</span><span class="p">):]</span>
        <span class="k">return</span> <span class="n">logsheet</span>

    <span class="k">def</span> <span class="nf">load_xlsx</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load the logsheet as a list of lists using Pandas.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list of logsheet values from excel&quot;&quot;&quot;</span>        
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="c1"># @profile(stream = read_logsheet_stream)</span>
    <span class="k">def</span> <span class="nf">read_logsheet</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run the logsheet import process.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: more header rows than logsheet rows or incorrect schema format?&quot;&quot;&quot;</span>
        <span class="n">action</span> <span class="o">=</span> <span class="n">Action</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;read logsheet&quot;</span><span class="p">)</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="nb">id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_dataset_id</span><span class="p">(),</span> <span class="n">action</span> <span class="o">=</span> <span class="n">action</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validate_class_column_names</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">class_column_names</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validate_headers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validate_num_header_rows</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_header_rows</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validate_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="c1"># 1. Load the logsheet (using built-in Python libraries)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s2">&quot;xlsx&quot;</span><span class="p">,</span> <span class="s2">&quot;xls&quot;</span><span class="p">)):</span>
            <span class="n">full_logsheet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_xlsx</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">full_logsheet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_and_clean_logsheet</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">full_logsheet</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_header_rows</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The number of header rows is greater than the number of rows in the logsheet!&quot;</span><span class="p">)</span>

        <span class="c1"># Run the logsheet import.</span>
        <span class="c1"># headers = full_logsheet[0:self.num_header_rows]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">full_logsheet</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_header_rows</span><span class="p">:</span>
            <span class="n">logsheet</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logsheet</span> <span class="o">=</span> <span class="n">full_logsheet</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">num_header_rows</span><span class="p">:]</span>

        <span class="c1"># logsheet = logsheet[0:50] # For testing purposes, only read the first 50 rows.</span>

        <span class="c1"># For each row, connect instances of the appropriate DataObject subclass to all other instances of appropriate DataObject subclasses.</span>
        <span class="n">headers_in_logsheet</span> <span class="o">=</span> <span class="n">full_logsheet</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">all_headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span>
        <span class="n">header_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">header</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">header</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">]</span>
        <span class="n">header_types</span> <span class="o">=</span> <span class="p">[</span><span class="n">header</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">header</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">]</span>
        <span class="n">header_levels</span> <span class="o">=</span> <span class="p">[</span><span class="n">header</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">header</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">]</span>
        <span class="n">header_vrids</span> <span class="o">=</span> <span class="p">[</span><span class="n">header</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="k">for</span> <span class="n">header</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">]</span>
        <span class="c1"># Load/create all of the Variables</span>
        <span class="n">vr_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">vr_obj_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">vr_id</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">header_vrids</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vr_id</span><span class="p">,</span> <span class="n">Variable</span><span class="p">):</span>
                <span class="n">vr</span> <span class="o">=</span> <span class="n">vr_id</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">vr</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="nb">id</span> <span class="o">=</span> <span class="n">vr_id</span><span class="p">,</span> <span class="n">action</span> <span class="o">=</span> <span class="n">action</span><span class="p">)</span>
            <span class="n">vr_obj_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vr</span><span class="p">)</span>
            <span class="n">vr_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vr</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>

        <span class="c1"># Order the class column names by precedence in the schema so that higher level objects always exist before lower level.</span>
        <span class="n">schema</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">schema</span>
        <span class="n">schema_graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
        <span class="n">schema_graph</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
        <span class="n">order</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">topological_sort</span><span class="p">(</span><span class="n">schema_graph</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">order</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The schema must have at least 2 elements including the Dataset!&quot;</span><span class="p">)</span>
        <span class="n">order</span> <span class="o">=</span> <span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="c1"># Remove the Dataset class from the order.</span>
        <span class="n">dobj_column_names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="bp">cls</span> <span class="ow">in</span> <span class="n">order</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">column_name</span><span class="p">,</span> <span class="n">cls_item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_column_names</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="bp">cls</span> <span class="ow">is</span> <span class="n">cls_item</span><span class="p">:</span>
                    <span class="n">dobj_column_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">column_name</span><span class="p">)</span>

        <span class="c1"># Create the data objects.</span>
        <span class="c1"># Get all of the names of the data objects, after they&#39;re cleaned for SQLite.</span>
        <span class="n">cols_idx</span> <span class="o">=</span> <span class="p">[</span><span class="n">headers_in_logsheet</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">header</span><span class="p">)</span> <span class="k">for</span> <span class="n">header</span> <span class="ow">in</span> <span class="n">dobj_column_names</span><span class="p">]</span> <span class="c1"># Get the indices of the data objects columns.</span>
        <span class="n">dobj_names</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># The matrix of data object names (values in the logsheet).</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">logsheet</span><span class="p">:</span>
            <span class="n">dobj_names</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
            <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">cols_idx</span><span class="p">:</span>
                <span class="n">raw_value</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
                <span class="n">type_class</span> <span class="o">=</span> <span class="n">header_types</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
                <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_clean_value</span><span class="p">(</span><span class="n">type_class</span><span class="p">,</span> <span class="n">raw_value</span><span class="p">)</span>
                <span class="n">dobj_names</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">row_num</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dobj_names</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span><span class="o">.</span><span class="n">isidentifier</span><span class="p">()</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">row</span><span class="p">]):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Row #</span><span class="si">{</span><span class="n">row_num</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">num_header_rows</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> (1-based): All data object names must be non-empty and valid variable names!&quot;</span><span class="p">)</span>
        <span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">id</span><span class="p">)</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">dobj_names</span><span class="p">]</span> <span class="c1"># Prepend the Dataset to the first column of each row.</span>
        <span class="n">name_ids_dict</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1"># The dict that maps the values (names) to the IDs. Separate dict for each class, each class is a top-level key of the dict.</span>
        <span class="n">name_ids_dict</span><span class="p">[</span><span class="n">Dataset</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">ds</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">ds</span><span class="o">.</span><span class="n">id</span><span class="p">}</span>
        <span class="n">name_dobjs_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">name_dobjs_dict</span><span class="p">[</span><span class="n">Dataset</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">ds</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">ds</span><span class="p">}</span>
        <span class="k">for</span> <span class="bp">cls</span> <span class="ow">in</span> <span class="n">order</span><span class="p">:</span>
            <span class="n">name_ids_dict</span><span class="p">[</span><span class="bp">cls</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1"># Initialize the dict for this class.            </span>
            <span class="n">name_dobjs_dict</span><span class="p">[</span><span class="bp">cls</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># Create the DataObject instances in the dict.        </span>
        <span class="n">all_dobjs_ordered</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># The list of lists of DataObject instances, ordered by the order of the schema.        </span>
        <span class="n">id_creator</span> <span class="o">=</span> <span class="n">IDCreator</span><span class="p">(</span><span class="n">action</span><span class="o">.</span><span class="n">conn</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">row_num</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dobj_names</span><span class="p">):</span>
            <span class="n">row</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
            <span class="n">all_dobjs_ordered</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">ds</span><span class="p">])</span> <span class="c1"># Add the Dataset to the beginning of each row.</span>
            <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">)):</span>
                <span class="bp">cls</span> <span class="o">=</span> <span class="n">order</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="c1"># The class to create.</span>
                <span class="n">col_idx</span> <span class="o">=</span> <span class="n">cols_idx</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="c1"># The index of the column in the logsheet.</span>
                <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_clean_value</span><span class="p">(</span><span class="n">header_types</span><span class="p">[</span><span class="n">col_idx</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
                <span class="c1"># NEED TO CHECK NOT ONLY IF THE VALUE MATCHES, BUT WHETHER THE ENTIRE LINEAGE MATCHES.</span>
                <span class="c1"># For example, condition names can be reused between subjects (though not within the same subject) but a new ID should be created for each lineage.</span>
                <span class="n">row_to_now</span> <span class="o">=</span> <span class="p">[</span><span class="n">ds</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">is_new</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="n">row_num</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">lst</span> <span class="ow">in</span> <span class="n">dobj_names</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">row_num</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">row_to_now</span><span class="p">)</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">lst</span><span class="p">)):</span>
                            <span class="n">is_new</span> <span class="o">=</span> <span class="kc">False</span>
                            <span class="k">break</span>
                <span class="k">if</span> <span class="n">is_new</span><span class="p">:</span>
                    <span class="n">name_ids_dict</span><span class="p">[</span><span class="bp">cls</span><span class="p">][</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="n">id_creator</span><span class="o">.</span><span class="n">create_ro_id</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">value</span>
                    <span class="n">dobj</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="nb">id</span> <span class="o">=</span> <span class="n">name_ids_dict</span><span class="p">[</span><span class="bp">cls</span><span class="p">][</span><span class="n">value</span><span class="p">],</span> <span class="n">name</span> <span class="o">=</span> <span class="n">value</span><span class="p">,</span> <span class="n">action</span> <span class="o">=</span> <span class="n">action</span><span class="p">)</span> <span class="c1"># Create the research object.</span>
                    <span class="n">name_dobjs_dict</span><span class="p">[</span><span class="bp">cls</span><span class="p">][</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="n">dobj</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Creating DataObject, Row: &quot;</span><span class="p">,</span> <span class="n">row_num</span><span class="p">,</span> <span class="s2">&quot;Column: &quot;</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">prefix</span><span class="p">,</span> <span class="s2">&quot;Value: &quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="s2">&quot;ID: &quot;</span><span class="p">,</span> <span class="n">dobj</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
                <span class="n">dobj</span> <span class="o">=</span> <span class="n">name_dobjs_dict</span><span class="p">[</span><span class="bp">cls</span><span class="p">][</span><span class="n">value</span><span class="p">]</span>
                <span class="n">all_dobjs_ordered</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dobj</span><span class="p">)</span> <span class="c1"># Matrix of all research objects.                                        </span>

        <span class="c1"># Assign the values to the DataObject instances.</span>
        <span class="c1"># Validates that the logsheet is of valid format.</span>
        <span class="c1"># i.e. Doesn&#39;t have conflicting values for one level (empty/None is OK)</span>
        <span class="n">attrs_cache_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">default_none_vals</span> <span class="o">=</span> <span class="p">{</span><span class="nb">str</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">int</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">))}</span>
        <span class="k">for</span> <span class="n">row_num</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">logsheet</span><span class="p">):</span>
            <span class="n">row_dobjs</span> <span class="o">=</span> <span class="n">all_dobjs_ordered</span><span class="p">[</span><span class="n">row_num</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>
            <span class="n">row_attrs</span> <span class="o">=</span> <span class="p">[{}</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">order</span><span class="p">))]</span> <span class="c1"># The list of dicts of attributes for each DataObject instance.</span>

            <span class="c1"># Assign all of the data to the appropriate DataObject instances.</span>
            <span class="c1"># Includes the &quot;data object columns&quot; so that the DataObjects have an attribute with the name of the header name.</span>
            <span class="k">for</span> <span class="n">header</span> <span class="ow">in</span> <span class="n">all_headers</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">header</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">col_idx</span> <span class="o">=</span> <span class="n">headers_in_logsheet</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>                
                <span class="n">type_class</span> <span class="o">=</span> <span class="n">header</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">level</span> <span class="o">=</span> <span class="n">header</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">level_idx</span> <span class="o">=</span> <span class="n">order</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>
                <span class="n">vr_id</span> <span class="o">=</span> <span class="n">header</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>                
                <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_clean_value</span><span class="p">(</span><span class="n">type_class</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="n">headers_in_logsheet</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">name</span><span class="p">)])</span>                                    
                <span class="c1"># Set up the cache dict for this data object.</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">row_dobjs</span><span class="p">[</span><span class="n">level_idx</span><span class="p">]</span><span class="o">.</span><span class="n">id</span> <span class="ow">in</span> <span class="n">attrs_cache_dict</span><span class="p">:</span>
                    <span class="n">attrs_cache_dict</span><span class="p">[</span><span class="n">row_dobjs</span><span class="p">[</span><span class="n">level_idx</span><span class="p">]</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="c1"># Set up the cache dict for this data object for this attribute.</span>
                <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">attrs_cache_dict</span><span class="p">[</span><span class="n">row_dobjs</span><span class="p">[</span><span class="n">level_idx</span><span class="p">]</span><span class="o">.</span><span class="n">id</span><span class="p">]:</span>
                    <span class="n">attrs_cache_dict</span><span class="p">[</span><span class="n">row_dobjs</span><span class="p">[</span><span class="n">level_idx</span><span class="p">]</span><span class="o">.</span><span class="n">id</span><span class="p">][</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">default_none_vals</span><span class="p">[</span><span class="n">type_class</span><span class="p">]</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Row: &quot;</span><span class="p">,</span> <span class="n">row_num</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">num_header_rows</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Column: &quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="s2">&quot;Value: &quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="n">prev_value</span> <span class="o">=</span> <span class="n">attrs_cache_dict</span><span class="p">[</span><span class="n">row_dobjs</span><span class="p">[</span><span class="n">level_idx</span><span class="p">]</span><span class="o">.</span><span class="n">id</span><span class="p">][</span><span class="n">name</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">prev_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">default_none_vals</span><span class="p">[</span><span class="n">type_class</span><span class="p">]</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">prev_value</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">prev_value</span><span class="p">)):</span>                    
                    <span class="k">if</span> <span class="n">prev_value</span> <span class="o">==</span> <span class="n">value</span> <span class="ow">or</span> <span class="n">value</span> <span class="o">==</span> <span class="n">default_none_vals</span><span class="p">[</span><span class="n">type_class</span><span class="p">]</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
                        <span class="k">continue</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Row # (1-based): </span><span class="si">{</span><span class="n">row_num</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">num_header_rows</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> Column: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> has conflicting values!&quot;</span><span class="p">)</span>
                <span class="n">attrs_cache_dict</span><span class="p">[</span><span class="n">row_dobjs</span><span class="p">[</span><span class="n">level_idx</span><span class="p">]</span><span class="o">.</span><span class="n">id</span><span class="p">][</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
                <span class="n">row_attrs</span><span class="p">[</span><span class="n">level_idx</span><span class="p">][</span><span class="n">vr_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">attrs_cache_dict</span><span class="p">[</span><span class="n">row_dobjs</span><span class="p">[</span><span class="n">level_idx</span><span class="p">]</span><span class="o">.</span><span class="n">id</span><span class="p">][</span><span class="n">name</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">attrs</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row_attrs</span><span class="p">):</span>
                <span class="n">row_dobjs</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">_setattrs</span><span class="p">({},</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">action</span> <span class="o">=</span> <span class="n">action</span><span class="p">,</span> <span class="n">pr_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>                           

        <span class="c1"># Arrange the address ID&#39;s that were generated into an edge list.</span>
        <span class="c1"># Then assign that to the Dataset.</span>
        <span class="n">addresses</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">all_dobjs_ordered</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">dobj</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">idx</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="n">idx</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">dobj</span><span class="o">.</span><span class="n">id</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">ids</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">addresses</span><span class="p">:</span>
                    <span class="n">addresses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ids</span><span class="p">)</span>
        <span class="n">all_default_attrs</span> <span class="o">=</span> <span class="n">DefaultAttrs</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
        <span class="n">ds</span><span class="o">.</span><span class="n">_setattrs</span><span class="p">(</span><span class="n">all_default_attrs</span><span class="o">.</span><span class="n">default_attrs</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;addresses&quot;</span><span class="p">:</span> <span class="n">addresses</span><span class="p">},</span> <span class="n">action</span> <span class="o">=</span> <span class="n">action</span><span class="p">,</span> <span class="n">pr_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="c1"># ds.addresses = addresses # Store addresses, also creates address_graph.</span>

        <span class="n">action</span><span class="o">.</span><span class="n">exec</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">action</span><span class="o">.</span><span class="n">commit</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">action</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span> <span class="c1"># Commit the action.</span>

    <span class="k">def</span> <span class="nf">_clean_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">type_class</span><span class="p">:</span> <span class="nb">type</span><span class="p">,</span> <span class="n">raw_value</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert to proper type and clean the value of the logsheet cell.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">type_class</span><span class="p">(</span><span class="n">raw_value</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">raw_value</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;&#39;&#39;&quot;</span><span class="p">)</span> <span class="c1"># Handle single quotes.</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span> <span class="c1"># Empty</span>
            <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">type_class</span> <span class="ow">is</span> <span class="nb">int</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">value</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h2 id="src.ResearchOS.PipelineObjects.logsheet.Logsheet.read_logsheet" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">read_logsheet</span><span class="p">()</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Run the logsheet import process.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>None</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>ValueError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>more header rows than logsheet rows or incorrect schema format?</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/ResearchOS/PipelineObjects/logsheet.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_logsheet</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Run the logsheet import process.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: more header rows than logsheet rows or incorrect schema format?&quot;&quot;&quot;</span>
    <span class="n">action</span> <span class="o">=</span> <span class="n">Action</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;read logsheet&quot;</span><span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="nb">id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_dataset_id</span><span class="p">(),</span> <span class="n">action</span> <span class="o">=</span> <span class="n">action</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">validate_class_column_names</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">class_column_names</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">validate_headers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">validate_num_header_rows</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_header_rows</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">validate_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="c1"># 1. Load the logsheet (using built-in Python libraries)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s2">&quot;xlsx&quot;</span><span class="p">,</span> <span class="s2">&quot;xls&quot;</span><span class="p">)):</span>
        <span class="n">full_logsheet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_xlsx</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">full_logsheet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_and_clean_logsheet</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">full_logsheet</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_header_rows</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The number of header rows is greater than the number of rows in the logsheet!&quot;</span><span class="p">)</span>

    <span class="c1"># Run the logsheet import.</span>
    <span class="c1"># headers = full_logsheet[0:self.num_header_rows]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">full_logsheet</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_header_rows</span><span class="p">:</span>
        <span class="n">logsheet</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logsheet</span> <span class="o">=</span> <span class="n">full_logsheet</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">num_header_rows</span><span class="p">:]</span>

    <span class="c1"># logsheet = logsheet[0:50] # For testing purposes, only read the first 50 rows.</span>

    <span class="c1"># For each row, connect instances of the appropriate DataObject subclass to all other instances of appropriate DataObject subclasses.</span>
    <span class="n">headers_in_logsheet</span> <span class="o">=</span> <span class="n">full_logsheet</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">all_headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span>
    <span class="n">header_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">header</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">header</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">]</span>
    <span class="n">header_types</span> <span class="o">=</span> <span class="p">[</span><span class="n">header</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">header</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">]</span>
    <span class="n">header_levels</span> <span class="o">=</span> <span class="p">[</span><span class="n">header</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">header</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">]</span>
    <span class="n">header_vrids</span> <span class="o">=</span> <span class="p">[</span><span class="n">header</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="k">for</span> <span class="n">header</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">]</span>
    <span class="c1"># Load/create all of the Variables</span>
    <span class="n">vr_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">vr_obj_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">vr_id</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">header_vrids</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vr_id</span><span class="p">,</span> <span class="n">Variable</span><span class="p">):</span>
            <span class="n">vr</span> <span class="o">=</span> <span class="n">vr_id</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">vr</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="nb">id</span> <span class="o">=</span> <span class="n">vr_id</span><span class="p">,</span> <span class="n">action</span> <span class="o">=</span> <span class="n">action</span><span class="p">)</span>
        <span class="n">vr_obj_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vr</span><span class="p">)</span>
        <span class="n">vr_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vr</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>

    <span class="c1"># Order the class column names by precedence in the schema so that higher level objects always exist before lower level.</span>
    <span class="n">schema</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">schema</span>
    <span class="n">schema_graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
    <span class="n">schema_graph</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
    <span class="n">order</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">topological_sort</span><span class="p">(</span><span class="n">schema_graph</span><span class="p">))</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">order</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The schema must have at least 2 elements including the Dataset!&quot;</span><span class="p">)</span>
    <span class="n">order</span> <span class="o">=</span> <span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="c1"># Remove the Dataset class from the order.</span>
    <span class="n">dobj_column_names</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="bp">cls</span> <span class="ow">in</span> <span class="n">order</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">column_name</span><span class="p">,</span> <span class="n">cls_item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_column_names</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">cls</span> <span class="ow">is</span> <span class="n">cls_item</span><span class="p">:</span>
                <span class="n">dobj_column_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">column_name</span><span class="p">)</span>

    <span class="c1"># Create the data objects.</span>
    <span class="c1"># Get all of the names of the data objects, after they&#39;re cleaned for SQLite.</span>
    <span class="n">cols_idx</span> <span class="o">=</span> <span class="p">[</span><span class="n">headers_in_logsheet</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">header</span><span class="p">)</span> <span class="k">for</span> <span class="n">header</span> <span class="ow">in</span> <span class="n">dobj_column_names</span><span class="p">]</span> <span class="c1"># Get the indices of the data objects columns.</span>
    <span class="n">dobj_names</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># The matrix of data object names (values in the logsheet).</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">logsheet</span><span class="p">:</span>
        <span class="n">dobj_names</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">cols_idx</span><span class="p">:</span>
            <span class="n">raw_value</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
            <span class="n">type_class</span> <span class="o">=</span> <span class="n">header_types</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_clean_value</span><span class="p">(</span><span class="n">type_class</span><span class="p">,</span> <span class="n">raw_value</span><span class="p">)</span>
            <span class="n">dobj_names</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">row_num</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dobj_names</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span><span class="o">.</span><span class="n">isidentifier</span><span class="p">()</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">row</span><span class="p">]):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Row #</span><span class="si">{</span><span class="n">row_num</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">num_header_rows</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> (1-based): All data object names must be non-empty and valid variable names!&quot;</span><span class="p">)</span>
    <span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">id</span><span class="p">)</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">dobj_names</span><span class="p">]</span> <span class="c1"># Prepend the Dataset to the first column of each row.</span>
    <span class="n">name_ids_dict</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1"># The dict that maps the values (names) to the IDs. Separate dict for each class, each class is a top-level key of the dict.</span>
    <span class="n">name_ids_dict</span><span class="p">[</span><span class="n">Dataset</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">ds</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">ds</span><span class="o">.</span><span class="n">id</span><span class="p">}</span>
    <span class="n">name_dobjs_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">name_dobjs_dict</span><span class="p">[</span><span class="n">Dataset</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">ds</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">ds</span><span class="p">}</span>
    <span class="k">for</span> <span class="bp">cls</span> <span class="ow">in</span> <span class="n">order</span><span class="p">:</span>
        <span class="n">name_ids_dict</span><span class="p">[</span><span class="bp">cls</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1"># Initialize the dict for this class.            </span>
        <span class="n">name_dobjs_dict</span><span class="p">[</span><span class="bp">cls</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># Create the DataObject instances in the dict.        </span>
    <span class="n">all_dobjs_ordered</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># The list of lists of DataObject instances, ordered by the order of the schema.        </span>
    <span class="n">id_creator</span> <span class="o">=</span> <span class="n">IDCreator</span><span class="p">(</span><span class="n">action</span><span class="o">.</span><span class="n">conn</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">row_num</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dobj_names</span><span class="p">):</span>
        <span class="n">row</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="n">all_dobjs_ordered</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">ds</span><span class="p">])</span> <span class="c1"># Add the Dataset to the beginning of each row.</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">)):</span>
            <span class="bp">cls</span> <span class="o">=</span> <span class="n">order</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="c1"># The class to create.</span>
            <span class="n">col_idx</span> <span class="o">=</span> <span class="n">cols_idx</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="c1"># The index of the column in the logsheet.</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_clean_value</span><span class="p">(</span><span class="n">header_types</span><span class="p">[</span><span class="n">col_idx</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
            <span class="c1"># NEED TO CHECK NOT ONLY IF THE VALUE MATCHES, BUT WHETHER THE ENTIRE LINEAGE MATCHES.</span>
            <span class="c1"># For example, condition names can be reused between subjects (though not within the same subject) but a new ID should be created for each lineage.</span>
            <span class="n">row_to_now</span> <span class="o">=</span> <span class="p">[</span><span class="n">ds</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">is_new</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="n">row_num</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">lst</span> <span class="ow">in</span> <span class="n">dobj_names</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">row_num</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">row_to_now</span><span class="p">)</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">lst</span><span class="p">)):</span>
                        <span class="n">is_new</span> <span class="o">=</span> <span class="kc">False</span>
                        <span class="k">break</span>
            <span class="k">if</span> <span class="n">is_new</span><span class="p">:</span>
                <span class="n">name_ids_dict</span><span class="p">[</span><span class="bp">cls</span><span class="p">][</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="n">id_creator</span><span class="o">.</span><span class="n">create_ro_id</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">value</span>
                <span class="n">dobj</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="nb">id</span> <span class="o">=</span> <span class="n">name_ids_dict</span><span class="p">[</span><span class="bp">cls</span><span class="p">][</span><span class="n">value</span><span class="p">],</span> <span class="n">name</span> <span class="o">=</span> <span class="n">value</span><span class="p">,</span> <span class="n">action</span> <span class="o">=</span> <span class="n">action</span><span class="p">)</span> <span class="c1"># Create the research object.</span>
                <span class="n">name_dobjs_dict</span><span class="p">[</span><span class="bp">cls</span><span class="p">][</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="n">dobj</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Creating DataObject, Row: &quot;</span><span class="p">,</span> <span class="n">row_num</span><span class="p">,</span> <span class="s2">&quot;Column: &quot;</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">prefix</span><span class="p">,</span> <span class="s2">&quot;Value: &quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="s2">&quot;ID: &quot;</span><span class="p">,</span> <span class="n">dobj</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
            <span class="n">dobj</span> <span class="o">=</span> <span class="n">name_dobjs_dict</span><span class="p">[</span><span class="bp">cls</span><span class="p">][</span><span class="n">value</span><span class="p">]</span>
            <span class="n">all_dobjs_ordered</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dobj</span><span class="p">)</span> <span class="c1"># Matrix of all research objects.                                        </span>

    <span class="c1"># Assign the values to the DataObject instances.</span>
    <span class="c1"># Validates that the logsheet is of valid format.</span>
    <span class="c1"># i.e. Doesn&#39;t have conflicting values for one level (empty/None is OK)</span>
    <span class="n">attrs_cache_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">default_none_vals</span> <span class="o">=</span> <span class="p">{</span><span class="nb">str</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">int</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">))}</span>
    <span class="k">for</span> <span class="n">row_num</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">logsheet</span><span class="p">):</span>
        <span class="n">row_dobjs</span> <span class="o">=</span> <span class="n">all_dobjs_ordered</span><span class="p">[</span><span class="n">row_num</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>
        <span class="n">row_attrs</span> <span class="o">=</span> <span class="p">[{}</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">order</span><span class="p">))]</span> <span class="c1"># The list of dicts of attributes for each DataObject instance.</span>

        <span class="c1"># Assign all of the data to the appropriate DataObject instances.</span>
        <span class="c1"># Includes the &quot;data object columns&quot; so that the DataObjects have an attribute with the name of the header name.</span>
        <span class="k">for</span> <span class="n">header</span> <span class="ow">in</span> <span class="n">all_headers</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">header</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">col_idx</span> <span class="o">=</span> <span class="n">headers_in_logsheet</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>                
            <span class="n">type_class</span> <span class="o">=</span> <span class="n">header</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">level</span> <span class="o">=</span> <span class="n">header</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">level_idx</span> <span class="o">=</span> <span class="n">order</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>
            <span class="n">vr_id</span> <span class="o">=</span> <span class="n">header</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>                
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_clean_value</span><span class="p">(</span><span class="n">type_class</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="n">headers_in_logsheet</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">name</span><span class="p">)])</span>                                    
            <span class="c1"># Set up the cache dict for this data object.</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">row_dobjs</span><span class="p">[</span><span class="n">level_idx</span><span class="p">]</span><span class="o">.</span><span class="n">id</span> <span class="ow">in</span> <span class="n">attrs_cache_dict</span><span class="p">:</span>
                <span class="n">attrs_cache_dict</span><span class="p">[</span><span class="n">row_dobjs</span><span class="p">[</span><span class="n">level_idx</span><span class="p">]</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="c1"># Set up the cache dict for this data object for this attribute.</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">attrs_cache_dict</span><span class="p">[</span><span class="n">row_dobjs</span><span class="p">[</span><span class="n">level_idx</span><span class="p">]</span><span class="o">.</span><span class="n">id</span><span class="p">]:</span>
                <span class="n">attrs_cache_dict</span><span class="p">[</span><span class="n">row_dobjs</span><span class="p">[</span><span class="n">level_idx</span><span class="p">]</span><span class="o">.</span><span class="n">id</span><span class="p">][</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">default_none_vals</span><span class="p">[</span><span class="n">type_class</span><span class="p">]</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Row: &quot;</span><span class="p">,</span> <span class="n">row_num</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">num_header_rows</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Column: &quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="s2">&quot;Value: &quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
            <span class="n">prev_value</span> <span class="o">=</span> <span class="n">attrs_cache_dict</span><span class="p">[</span><span class="n">row_dobjs</span><span class="p">[</span><span class="n">level_idx</span><span class="p">]</span><span class="o">.</span><span class="n">id</span><span class="p">][</span><span class="n">name</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">prev_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">default_none_vals</span><span class="p">[</span><span class="n">type_class</span><span class="p">]</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">prev_value</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">prev_value</span><span class="p">)):</span>                    
                <span class="k">if</span> <span class="n">prev_value</span> <span class="o">==</span> <span class="n">value</span> <span class="ow">or</span> <span class="n">value</span> <span class="o">==</span> <span class="n">default_none_vals</span><span class="p">[</span><span class="n">type_class</span><span class="p">]</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
                    <span class="k">continue</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Row # (1-based): </span><span class="si">{</span><span class="n">row_num</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">num_header_rows</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> Column: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> has conflicting values!&quot;</span><span class="p">)</span>
            <span class="n">attrs_cache_dict</span><span class="p">[</span><span class="n">row_dobjs</span><span class="p">[</span><span class="n">level_idx</span><span class="p">]</span><span class="o">.</span><span class="n">id</span><span class="p">][</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
            <span class="n">row_attrs</span><span class="p">[</span><span class="n">level_idx</span><span class="p">][</span><span class="n">vr_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">attrs_cache_dict</span><span class="p">[</span><span class="n">row_dobjs</span><span class="p">[</span><span class="n">level_idx</span><span class="p">]</span><span class="o">.</span><span class="n">id</span><span class="p">][</span><span class="n">name</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">attrs</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row_attrs</span><span class="p">):</span>
            <span class="n">row_dobjs</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">_setattrs</span><span class="p">({},</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">action</span> <span class="o">=</span> <span class="n">action</span><span class="p">,</span> <span class="n">pr_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>                           

    <span class="c1"># Arrange the address ID&#39;s that were generated into an edge list.</span>
    <span class="c1"># Then assign that to the Dataset.</span>
    <span class="n">addresses</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">all_dobjs_ordered</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">dobj</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">idx</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="n">idx</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">dobj</span><span class="o">.</span><span class="n">id</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">ids</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">addresses</span><span class="p">:</span>
                <span class="n">addresses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ids</span><span class="p">)</span>
    <span class="n">all_default_attrs</span> <span class="o">=</span> <span class="n">DefaultAttrs</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
    <span class="n">ds</span><span class="o">.</span><span class="n">_setattrs</span><span class="p">(</span><span class="n">all_default_attrs</span><span class="o">.</span><span class="n">default_attrs</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;addresses&quot;</span><span class="p">:</span> <span class="n">addresses</span><span class="p">},</span> <span class="n">action</span> <span class="o">=</span> <span class="n">action</span><span class="p">,</span> <span class="n">pr_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
    <span class="c1"># ds.addresses = addresses # Store addresses, also creates address_graph.</span>

    <span class="n">action</span><span class="o">.</span><span class="n">exec</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">action</span><span class="o">.</span><span class="n">commit</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">action</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span> <span class="c1"># Commit the action.</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.path", "navigation.tabs", "navigation.tabs.sticky", "navigation.expand", "toc.follow", "navigation.top"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.bd41221c.min.js"></script>
      
    
  </body>
</html>